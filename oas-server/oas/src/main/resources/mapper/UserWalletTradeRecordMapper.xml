<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cascv.oas.server.blockchain.mapper.UserWalletTradeRecordMapper">

  <resultMap id="UserWalletTradeRecordMap" type="com.cascv.oas.server.blockchain.wrapper.UserWalletTradeRecordInfo">
	<result column="name" property="name"/>
	<result column="value" property="value"/>
	<result column="title" property="title"/>
	<result column="change_user_name" property="changeUserName"/>
	<result column="created" property="created"/>
	<result column="remark" property="remark"/>
  </resultMap>
  
  <select id="selectAllTradeRecord" resultMap="UserWalletTradeRecordMap">
select 
	  u.name,ud.value,ud.title,ud.change_user_name,ud.created,ud.remark 
from 
	  user_wallet_detail ud,user_info u
where
	  ud.user_uuid=u.uuid
order by ud.created desc
</select>

<resultMap id="userWalletTotalTradeRecordMap" type="com.cascv.oas.server.blockchain.wrapper.UserWalletTotalTradeRecordInfo">
    <result column="name" property="name"/>
	<result column="value" property="value"/>
</resultMap> 
  
<select id="selectAllInTotalTradeRecord" resultMap="userWalletTotalTradeRecordMap">
select 
	  u.name,SUM(ud.value) as value
from 
	  user_wallet_detail ud,user_info u

where
	  ud.user_uuid=u.uuid and ud.in_or_out=1 and DATE_FORMAT(ud.created,"%Y-%m-%d") BETWEEN #{startTime} and #{endTime}

group by u.name 
order by value desc
</select>
   
<select id="selectAllOutTotalTradeRecord" resultMap="userWalletTotalTradeRecordMap">
select 
	  u.name,SUM(ud.value) as value
from 
	  user_wallet_detail ud,user_info u

where
	  ud.user_uuid=u.uuid and ud.in_or_out=0 and DATE_FORMAT(ud.created,"%Y-%m-%d") BETWEEN #{startTime} and #{endTime}

group by u.name 
order by value desc
   </select>
</mapper>