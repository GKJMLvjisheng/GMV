<?xml version="1.0" encoding="UTF-8"?>
<!-- Name:NewsManage -->
<!-- Author:yangming -->
<!-- Date:2018.09.04 -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cascv.oas.server.news.mapper.NewsModelMapper">

  <resultMap id="newsModelMap" type="com.cascv.oas.server.news.model.NewsModel">
	<id column="news_id" property="newsId" />
	<result column="news_title" property="newsTitle"/>
	<result column="news_abstract" property="newsAbstract"/>
	<result column="news_url" property="newsUrl"/>
  	<result column="news_picture_path" property="newsPicturePath"/>
  	<result column="created" property="created"/>
  </resultMap>
 
  <sql id="Base_Column_List">
  		news_id,
    	news_title,
    	news_abstract,
    	news_url,
    	news_picture_path,
    	created
  </sql>
  
  <!-- insert news -->
  <insert id="insertNews" parameterType="com.cascv.oas.server.news.model.NewsModel">
    <selectKey keyProperty="newsId" order="AFTER" resultType="java.lang.Integer">
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into news_info
    <trim prefix="(" suffix=")" suffixOverrides=",">
      
      <if test="newsTitle != null">
        news_title,
      </if>
      <if test="newsAbstract != null">
        news_abstract,
      </if>
      <if test="newsUrl != null">
        news_url,
      </if>
      <if test="newsPicturePath != null">
        news_picture_path,
      </if>
      <if test="created != null">
        created,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
    
      <if test="newsTitle != null">
        #{newsTitle,jdbcType=VARCHAR},
      </if>
      <if test="newsAbstract != null">
        #{newsAbstract,jdbcType=VARCHAR},
      </if>
      <if test="newsUrl != null">
        #{newsUrl,jdbcType=VARCHAR},
      </if>
      <if test="newsPicturePath != null">
        #{newsPicturePath,jdbcType=VARCHAR},
      </if>
	  <if test="created != null">
         #{created,jdbcType=VARCHAR},
      </if>
    </trim>
   </insert>
  
  <!-- delete news -->
  <delete id="deleteNews">
    delete from news_info where news_id = #{newsId}
  </delete>

  <select id="selectAllNews" resultMap="newsModelMap">
  	select 
  	<include refid="Base_Column_List" />
  	from news_info
  </select>

  <select id="selectPage" resultMap="newsModelMap">
  	select 
  	<include refid="Base_Column_List" />
  	from news_info order by created  desc limit #{offset},#{limit};
  </select>

  <select id="countTotal" resultType="java.lang.Integer">
  	select count(*) from news_info;
  </select>
  


    <update id="updateNews" parameterType="com.cascv.oas.server.news.model.NewsModel">
update 
		news_info 
set 
      	news_title= #{newsTitle},
      	news_abstract = #{newsAbstract},
      	news_url= #{newsUrl},
      	news_picture_path= #{newsPicturePath}
where 
		news_id = #{newsId}
    </update>
    
</mapper>

